(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{215:function(e,a){},224:function(e,a,t){"use strict";t.r(a);var s=t(0),c=t.n(s),r=t(12),l=t(9),n=t(13),m=t(2),o=t(190),i=t.n(o);a.default=()=>{const e=Object(s.useContext)(r.a),a=Object(s.useContext)(l.a),t=Object(s.useRef)(null),o=Object(s.useRef)(null),[u,h]=Object(n.a)({fieldValue:"",chatMessages:[]}),p=Object(s.useRef)(null);console.log(u.chatMessages);return Object(s.useEffect)(()=>{a.isChatOpen&&(p.current.focus(),e({type:"clearReadMessages"}))},[a.isChatOpen]),Object(s.useEffect)(()=>(o.current=i()("http://localhost:8080"),o.current.on("chatFromServer",e=>{console.log("here"),h(a=>{console.log(a),a.chatMessages.push(e)})}),()=>o.current.disconnect()),[]),Object(s.useEffect)(()=>{t.current.scrollTop=t.current.scrollHeight,u.chatMessages.length&&!a.isChatOpen&&e({type:"incrementUnreadMessages"})},[u.chatMessages]),c.a.createElement("div",{id:"chat-wrapper",className:`chat-wrapper  shadow border-top border-left border-right ${a.isChatOpen?"chat-wrapper--is-visible":" "} `},c.a.createElement("div",{className:"chat-title-bar bg-primary"},"Chat",c.a.createElement("span",{onClick:()=>e({type:"crossCloseChat"}),className:"chat-title-bar-close"},c.a.createElement("i",{className:"fas fa-times-circle"}))),c.a.createElement("div",{id:"chat",className:"chat-log",ref:t},u.chatMessages.map((e,t)=>e.username===a.user.username?c.a.createElement("div",{className:"chat-self",key:t},c.a.createElement("div",{className:"chat-message"},c.a.createElement("div",{className:"chat-message-inner"},e.message)),c.a.createElement("img",{className:"chat-avatar avatar-tiny",src:e.avatar})):c.a.createElement("div",{key:t,className:"chat-other"},c.a.createElement(m.b,{to:"/profile/"+e.username},c.a.createElement("img",{className:"avatar-tiny",src:e.avatar,alt:"test"})),c.a.createElement("div",{className:"chat-message"},c.a.createElement("div",{className:"chat-message-inner"},c.a.createElement(m.b,{to:"/profile/"+e.username},c.a.createElement("strong",null,e.username,": ")),e.message))))),c.a.createElement("form",{onSubmit:e=>{e.preventDefault(),console.log(u.fieldValue),o.current.emit("chatFromBrowser",{message:u.fieldValue,token:a.user.token}),h(e=>{e.chatMessages.push({message:u.fieldValue,username:a.user.username,avatar:a.user.avatar}),e.fieldValue=""})},id:"chatForm",className:"chat-form border-top"},c.a.createElement("input",{type:"text",ref:p,value:u.fieldValue,className:"chat-field",id:"chatField",placeholder:"Type a messageâ€¦",autoComplete:"off",onChange:e=>{const a=e.target.value;h(e=>{e.fieldValue=a})}})))}}}]);